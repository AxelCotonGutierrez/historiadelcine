---
layout: default
title: Buscador
permalink: /Buscador/
description: Buscador de pel칤culas, directores, actores, ...
comments: true
---

<div class="container" style="max-width: 900px;">
  <h1>游꿟 Buscador por categor칤a</h1>

  <!-- Inputs independientes por categor칤a -->
  <div class="form-group mb-3">
    <label for="input-directores">Directores</label>
    <input id="input-directores" class="form-control" placeholder="Buscar director...">
  </div>

  <div class="form-group mb-3">
    <label for="input-productores">Productores</label>
    <input id="input-productores" class="form-control" placeholder="Buscar productor...">
  </div>

  <div class="form-group mb-3">
    <label for="input-guionistas">Guionistas</label>
    <input id="input-guionistas" class="form-control" placeholder="Buscar guionista...">
  </div>

  <div class="form-group mb-3">
    <label for="input-actores">Actores</label>
    <input id="input-actores" class="form-control" placeholder="Buscar actor...">
  </div>

  <div class="form-group mb-3">
    <label for="input-estudio">Estudios</label>
    <input id="input-estudio" class="form-control" placeholder="Buscar estudio...">
  </div>

  <div class="form-group mb-3">
    <label for="input-paises">Pa칤ses</label>
    <input id="input-paises" class="form-control" placeholder="Buscar pa칤s...">
  </div>

  <div class="form-group mb-3">
    <label for="input-ano">A침os</label>
    <input id="input-ano" class="form-control" placeholder="Buscar a침o...">
  </div>

  <hr>
  <div id="resultados"></div>
</div>

<!-- Choices.js CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">

<!-- Choices.js JS -->
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

<script>
const BASE = "{{ '/assets/js/json_generados/' | relative_url }}";
const categorias = {
  "directores": "por_directores",
  "productores": "por_productores",
  "guionistas": "por_guionistas",
  "actores": "por_actores",
  "estudio": "por_estudio",
  "paises": "por_paises",
  "ano": "por_a침o"
};

const inputs = {};
const indexCache = {};

// 1) Inicializa Choices para cada input y carga index.json de su carpeta
for (const [inputId, carpeta] of Object.entries(categorias)) {
  const selector = `#input-${inputId}`;
  const choices = new Choices(selector, {
    removeItemButton: true,
    placeholder: true,
    shouldSort: true,
    searchEnabled: true
  });
  inputs[inputId] = choices;

  // Cargar index.json de la carpeta
  fetch(`${BASE}${carpeta}/index.json`)
    .then(r => r.json())
    .then(data => {
      indexCache[inputId] = data;
      const opciones = data.map(item => ({ value: item, label: item }));
      choices.setChoices(opciones, 'value', 'label', true);
    });
}

// 2) Al seleccionar opci칩n, buscar su JSON y mostrar detalles
for (const [inputId, carpeta] of Object.entries(categorias)) {
  inputs[inputId].passedElement.element.addEventListener('change', e => {
    const valor = e.detail.value;
    if (!valor) return;

    const archivo = valor.replace(/ /g, "_") + ".json";
    const url = `${BASE}${carpeta}/${archivo}`;

    fetch(url)
      .then(r => r.json())
      .then(data => mostrarFicha(data))
      .catch(() => {
        document.getElementById("resultados").innerHTML = "<p>No encontrado.</p>";
      });
  });
}

// 3) Mostrar resultados
function mostrarFicha(peliculas) {
  const cont = document.getElementById("resultados");
  cont.innerHTML = "";
  peliculas.forEach(p => {
    cont.innerHTML += `
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title">${p.titulo} (${p.a침o})</h5>
          <p class="card-text"><strong>T칤tulo original:</strong> ${p.titulo_original || ""}</p>
          <p class="card-text">${p.resumen_breve || ""}</p>
          <p><a href="${p.post}" class="btn btn-primary btn-sm">Ver ficha completa</a></p>
        </div>
      </div>
    `;
  });
}
</script>


