---
layout: default
title: Buscador
permalink: /Buscador/
description: Buscador de pelÃ­culas, directores, actores, ...
comments: true
---

<div class="container" style="max-width: 900px;">
  <h1>ðŸŽ¬ Buscador por categorÃ­a</h1>

  <!-- Directores -->
  <div class="form-group mb-3">
    <label for="input-directores">Directores</label>
    <input id="input-directores" class="form-control" list="list-directores" placeholder="Buscar director...">
    <datalist id="list-directores"></datalist>
  </div>

  <!-- Productores -->
  <div class="form-group mb-3">
    <label for="input-productores">Productores</label>
    <input id="input-productores" class="form-control" list="list-productores" placeholder="Buscar productor...">
    <datalist id="list-productores"></datalist>
  </div>

  <!-- Guionistas -->
  <div class="form-group mb-3">
    <label for="input-guionistas">Guionistas</label>
    <input id="input-guionistas" class="form-control" list="list-guionistas" placeholder="Buscar guionista...">
    <datalist id="list-guionistas"></datalist>
  </div>

  <!-- Actores -->
  <div class="form-group mb-3">
    <label for="input-actores">Actores</label>
    <input id="input-actores" class="form-control" list="list-actores" placeholder="Buscar actor...">
    <datalist id="list-actores"></datalist>
  </div>

  <!-- Estudios -->
  <div class="form-group mb-3">
    <label for="input-estudio">Estudios</label>
    <input id="input-estudio" class="form-control" list="list-estudio" placeholder="Buscar estudio...">
    <datalist id="list-estudio"></datalist>
  </div>

  <!-- PaÃ­ses -->
  <div class="form-group mb-3">
    <label for="input-paises">PaÃ­ses</label>
    <input id="input-paises" class="form-control" list="list-paises" placeholder="Buscar paÃ­s...">
    <datalist id="list-paises"></datalist>
  </div>

  <!-- AÃ±os -->
  <div class="form-group mb-3">
    <label for="input-ano">AÃ±os</label>
    <input id="input-ano" class="form-control" list="list-ano" placeholder="Buscar aÃ±o...">
    <datalist id="list-ano"></datalist>
  </div>

  <hr>
  <div id="resultados"></div>
</div>


<script>
const BASE = "{{ '/assets/js/json_generados/' | relative_url }}";
const categorias = {
  "directores": "por_directores",
  "productores": "por_productores",
  "guionistas": "por_guionistas",
  "actores": "por_actores",
  "estudio": "por_estudio",
  "paises": "por_paises",
  "ano": "por_aÃ±o"
};

// Guardar etiquetas en memoria
const etiquetas = {};

// Cargar todos los index.json al inicio
for (const [id, carpeta] of Object.entries(categorias)) {
  fetch(`${BASE}${carpeta}/index.json`)
    .then(r => r.json())
    .then(data => {
      etiquetas[id] = data;
    });
}

// Escuchar cada input: filtrar y actualizar datalist
for (const [id, carpeta] of Object.entries(categorias)) {
  const input = document.getElementById(`input-${id}`);
  const datalist = document.getElementById(`list-${id}`);

  input.addEventListener('input', () => {
    const texto = input.value.toLowerCase();
    const filtrados = (etiquetas[id] || []).filter(name =>
      name.toLowerCase().includes(texto)
    );

    datalist.innerHTML = "";
    filtrados.forEach(name => {
      datalist.innerHTML += `<option value="${name}">`;
    });
  });

  // Al elegir uno exacto â†’ cargar JSON
  input.addEventListener('change', () => {
    const valor = input.value.trim();
    if (!valor) return;
    const archivo = valor.replace(/ /g, "_") + ".json";
    fetch(`${BASE}${carpeta}/${archivo}`)
      .then(r => r.json())
      .then(data => mostrarFicha(data))
      .catch(() => {
        document.getElementById("resultados").innerHTML = "<p>No encontrado.</p>";
      });
  });
}

// Mostrar ficha detallada
function mostrarFicha(peliculas) {
  const cont = document.getElementById("resultados");
  cont.innerHTML = "";

  // Cabecera de tabla con todos los campos
  let html = `
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>AÃ±o</th>
          <th>TÃ­tulo</th>
          <th>TÃ­tulo Original</th>
          <th>DuraciÃ³n</th>
          <th>Directores</th>
          <th>Productores</th>
          <th>Guionistas</th>
          <th>Actores</th>
          <th>Estudio</th>
          <th>PaÃ­ses</th>
          <th>Observaciones</th>
        </tr>
      </thead>
      <tbody>
  `;

  peliculas.forEach(p => {
    html += `
      <tr>
        <td>${p.aÃ±o || "â€”"}</td>
        <td>${p.titulo || "â€”"}</td>
        <td>${p.titulo_original || "â€”"}</td>
        <td>${p.duracion || "â€”"}</td>
        <td>${(p.directores || []).join(", ") || "â€”"}</td>
        <td>${(p.productores || []).join(", ") || "â€”"}</td>
        <td>${(p.guionistas || []).join(", ") || "â€”"}</td>
        <td>${(p.actores || []).join(", ") || "â€”"}</td>
        <td>${(p.estudio || []).join(", ") || "â€”"}</td>
        <td>${(p.paises || []).join(", ") || "â€”"}</td>
        <td>${p.observaciones || "â€”"}</td>
      </tr>
    `;
  });

  html += `
      </tbody>
    </table>
  `;

  cont.innerHTML = html;
}

</script>

