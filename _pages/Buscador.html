---
layout: default
title: Buscador
permalink: /Buscador/
description: Buscador de pel√≠culas, directores, actores, ...
comments: true
---

<div class="container" style="max-width: 900px;">
  <h1>üé¨ Buscador por categor√≠a</h1>

  <!-- Directores -->
  <div class="form-group mb-3">
    <label for="input-directores">Directores</label>
    <input id="input-directores" class="form-control" list="list-directores" placeholder="Buscar director...">
    <datalist id="list-directores"></datalist>
  </div>

  <!-- Productores -->
  <div class="form-group mb-3">
    <label for="input-productores">Productores</label>
    <input id="input-productores" class="form-control" list="list-productores" placeholder="Buscar productor...">
    <datalist id="list-productores"></datalist>
  </div>

  <!-- Guionistas -->
  <div class="form-group mb-3">
    <label for="input-guionistas">Guionistas</label>
    <input id="input-guionistas" class="form-control" list="list-guionistas" placeholder="Buscar guionista...">
    <datalist id="list-guionistas"></datalist>
  </div>

  <!-- Actores -->
  <div class="form-group mb-3">
    <label for="input-actores">Actores</label>
    <input id="input-actores" class="form-control" list="list-actores" placeholder="Buscar actor...">
    <datalist id="list-actores"></datalist>
  </div>

  <!-- Estudios -->
  <div class="form-group mb-3">
    <label for="input-estudio">Estudios</label>
    <input id="input-estudio" class="form-control" list="list-estudio" placeholder="Buscar estudio...">
    <datalist id="list-estudio"></datalist>
  </div>

  <!-- Pa√≠ses -->
  <div class="form-group mb-3">
    <label for="input-paises">Pa√≠ses</label>
    <input id="input-paises" class="form-control" list="list-paises" placeholder="Buscar pa√≠s...">
    <datalist id="list-paises"></datalist>
  </div>

  <!-- A√±os -->
  <div class="form-group mb-3">
    <label for="input-ano">A√±os</label>
    <input id="input-ano" class="form-control" list="list-ano" placeholder="Buscar a√±o...">
    <datalist id="list-ano"></datalist>
  </div>

  <hr>
  <div id="resultados"></div>
</div>


<script>
const BASE = "{{ '/assets/js/json_generados/' | relative_url }}";
const categorias = {
  "directores": "por_directores",
  "productores": "por_productores",
  "guionistas": "por_guionistas",
  "actores": "por_actores",
  "estudio": "por_estudio",
  "paises": "por_paises",
  "ano": "por_a√±o"
};

// Guardar etiquetas en memoria
const etiquetas = {};

// Cargar todos los index.json al inicio
for (const [id, carpeta] of Object.entries(categorias)) {
  fetch(`${BASE}${carpeta}/index.json`)
    .then(r => r.json())
    .then(data => {
      etiquetas[id] = data;
    });
}

// Escuchar cada input: filtrar y actualizar datalist
for (const [id, carpeta] of Object.entries(categorias)) {
  const input = document.getElementById(`input-${id}`);
  const datalist = document.getElementById(`list-${id}`);

  input.addEventListener('input', () => {
    const texto = input.value.toLowerCase();
    const filtrados = (etiquetas[id] || []).filter(name =>
      name.toLowerCase().includes(texto)
    );

    datalist.innerHTML = "";
    filtrados.forEach(name => {
      datalist.innerHTML += `<option value="${name}">`;
    });
  });

  // Al elegir uno exacto ‚Üí cargar JSON
  input.addEventListener('change', () => {
    const valor = input.value.trim();
    if (!valor) return;
    const archivo = valor.replace(/ /g, "_") + ".json";
    fetch(`${BASE}${carpeta}/${archivo}`)
      .then(r => r.json())
      .then(data => mostrarFicha(data))
      .catch(() => {
        document.getElementById("resultados").innerHTML = "<p>No encontrado.</p>";
      });
  });
}

// Mostrar ficha detallada
function mostrarFicha(peliculas) {
  const cont = document.getElementById("resultados");
  cont.innerHTML = "";
  peliculas.forEach(p => {
    cont.innerHTML += `
      <div class="card mb-3">
        <div class="card-body">
          <h5>${p.titulo} (${p.a√±o})</h5>
          <p><strong>T√≠tulo original:</strong> ${p.titulo_original || ""}</p>
          <p><strong>Duraci√≥n:</strong> ${p.duracion || "‚Äî"}</p>
          <p><strong>Directores:</strong> ${(p.directores || []).join(", ")}</p>
          <p><strong>Productores:</strong> ${(p.productores || []).join(", ")}</p>
          <p><strong>Guionistas:</strong> ${(p.guionistas || []).join(", ")}</p>
          <p><strong>Actores:</strong> ${(p.actores || []).join(", ")}</p>
          <p><strong>Estudio:</strong> ${(p.estudio || []).join(", ")}</p>
          <p><strong>Pa√≠ses:</strong> ${(p.paises || []).join(", ")}</p>
          <p>${p.resumen_breve || ""}</p>
          <p><a href="${p.post}" class="btn btn-sm btn-primary">Ver ficha completa</a></p>
        </div>
      </div>
    `;
  });
}
</script>

