---
layout: default
title: Etiquetas
permalink: /tags/
---

{% comment %}
Genera todas las etiquetas agrupadas por letra inicial, preservando tu estructura.
{% endcomment %}

{% assign tag_posts = site.posts | where_exp: "post", "post.tags.size > 0" %}

{% assign tags = "" %}
{% for post in tag_posts %}
  {% assign tags = tags | concat: post.tags | uniq %}
{% endfor %}

{% assign sorted_tags = tags | sort %}

{% comment %}
Agrupa por primera letra
{% endcomment %}
{% assign grouped = {} %}
{% for tag in sorted_tags %}
  {% assign first = tag | slice: 0 | upcase %}
  {% if grouped[first] %}
    {% assign grouped = grouped | merge: { first: grouped[first] | push: tag } %}
  {% else %}
    {% assign grouped = grouped | merge: { first: [tag] } %}
  {% endif %}
{% endfor %}

<br/>

<!-- ✅ Mostrar por bloques de letra -->
{% assign keys = grouped | keys | sort %}
{% for letter in keys %}
  <details style="margin-bottom: 1em;">
    <summary><strong>{{ letter }}</strong> ({{ grouped[letter].size }})</summary>
    {% for tag in grouped[letter] | sort %}
      <a class="label label-success tag-link" href="#" data-tag="{{ tag | slugify }}">{{ tag }}</a> &nbsp;
    {% endfor %}
  </details>
{% endfor %}

<!-- ✅ Mantén el mismo bloque de posts por etiqueta -->
{% for tag in sorted_tags %}
  <div id="{{ tag | slugify }}" class="related-posts" style="display: none;">
    <h4>{{ tag }}</h4>
    <ul>
      {% assign tag_related_posts = tag_posts | where: "tags", tag %}
      {% for post in tag_related_posts %}
        <li>
          <a href="{{ site.baseurl }}{{ post.url }}">
            {{ post.title }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
{% endfor %}

<br><br><br>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var tagLinks = document.querySelectorAll('.tag-link');

  tagLinks.forEach(function(tagLink) {
    tagLink.addEventListener('click', function(e) {
      e.preventDefault();

      // Oculta todos los divs de posts relacionados
      var relatedPostsDivs = document.querySelectorAll('.related-posts');
      relatedPostsDivs.forEach(function(div) {
        div.style.display = 'none';
      });

      // Muestra el div específico para la etiqueta seleccionada
      var tag = tagLink.getAttribute('data-tag');
      var selectedDiv = document.getElementById(tag);
      if (selectedDiv) {
        selectedDiv.style.display = 'block';
      }
    });
  });
});
</script>
